# 📲 二维码功能使用指南

## 🎯 功能概述

系统新增了两个真实可扫码的二维码功能：
1. **📱 扫码投票**：手机扫码后可为菜品和厨师投票
2. **💬 心声墙**：手机扫码后可匿名发表吐槽和建议

---

## 📺 大屏显示

### 二维码位置
在前台看板页面（`index.html`）的右下角，会显示两个二维码：

```
┌─────────────────────────┐
│  [厨师信息卡片]         │
│  ┌─────────┬─────────┐  │
│  │ [QR码]  │ [QR码]  │  │
│  │ 扫码投票│ 心声墙  │  │
│  └─────────┴─────────┘  │
└─────────────────────────┘
```

### 自动生成
- 二维码在页面加载时自动生成
- 内容为当前服务器地址 + 对应页面路径
- 例如：`http://localhost:3010/mobile-vote.html`

---

## 📱 手机端投票页面

### 访问方式
1. **扫码访问**：用手机扫描"扫码投票"二维码
2. **直接访问**：在手机浏览器输入 `http://localhost:3010/mobile-vote.html`

### 功能特点
- ✅ **菜品投票**：为你喜欢的菜品点赞或踩
- ✅ **厨师信息**：查看厨师排行榜和个人信息
- ✅ **标签切换**：在"菜品投票"和"厨师投票"间切换
- ✅ **实时同步**：投票结果立即显示在大屏上

### 操作步骤
1. 扫码进入投票页面
2. 默认显示"菜品投票"标签
3. 点击菜品卡片上的 👍 或 👎 按钮投票
4. 切换到"厨师投票"标签查看厨师信息
5. 投票数据实时同步到服务器

### 界面特色
- 🎨 绿色渐变背景
- 📊 排名徽章（前3名金色高亮）
- ⚡ 按压反馈动画
- 📱 完美适配手机屏幕

---

## 💬 心声墙论坛

### 访问方式
1. **扫码访问**：用手机扫描"心声墙"二维码
2. **直接访问**：在手机浏览器输入 `http://localhost:3010/mobile-forum.html`

### 功能特点
- ✅ **匿名发帖**：无需登录，完全匿名
- ✅ **自由表达**：吐槽、建议、心声
- ✅ **点赞互动**：为认同的帖子点赞
- ✅ **实时统计**：显示帖子总数和点赞总数

### 发帖步骤
1. 扫码进入心声墙
2. 点击右下角的 ✍️ 浮动按钮
3. 在弹窗中输入内容（5-500字）
4. 点击"发布"按钮
5. 帖子立即显示在列表顶部

### 点赞操作
1. 浏览帖子列表
2. 点击帖子底部的 🤍 图标点赞
3. 点赞后图标变为 ❤️（红色）
4. 再次点击可取消点赞

### 界面特色
- 🎨 紫色渐变背景
- 💬 匿名头像（可爱表情符号）
- ⏰ 相对时间显示（刚刚、5分钟前...）
- 📊 顶部统计栏
- ✨ 平滑动画效果

---

## 🔧 技术实现

### 二维码生成
使用 `qrcode` 库实时生成：

```javascript
// API: GET /api/qrcode/:type
// type: 'vote' 或 'forum'

// 返回格式
{
    success: true,
    qrcode: "data:image/png;base64,iVBOR...",
    url: "http://localhost:3010/mobile-vote.html"
}
```

### 数据存储
论坛数据存储在 `forum-data.json`：

```json
{
  "posts": [
    {
      "id": 1733654321000,
      "content": "今天的菜很好吃！",
      "likes": 5,
      "timestamp": 1733654321000
    }
  ]
}
```

### API 接口
1. **获取帖子**：`GET /api/forum/posts`
2. **发布帖子**：`POST /api/forum/post`
3. **点赞操作**：`POST /api/forum/like`
4. **生成二维码**：`GET /api/qrcode/:type`

---

## 🚀 部署建议

### 局域网访问
如需要同一局域网的手机扫码访问：

1. 获取电脑的局域网 IP 地址：
```bash
# macOS/Linux
ifconfig | grep "inet "

# Windows
ipconfig
```

2. 修改 `server.js` 中的 URL 生成逻辑：
```javascript
// 替换 localhost 为实际 IP
const url = `http://192.168.1.100:${PORT}/mobile-vote.html`;
```

3. 重启服务器

### 外网访问
如需要外网访问，可使用：
- **内网穿透**：ngrok, frp
- **云服务器**：部署到云服务器
- **Fly.io**：项目已包含 fly.toml 配置

---

## 🛡️ 安全说明

### 内容审核
- ✅ 字数限制：5-500字
- ✅ HTML 转义：防止 XSS 攻击
- ✅ 匿名设计：无需个人信息

### 未来改进
- 敏感词过滤
- 举报功能
- 管理员审核
- 帖子删除权限

---

## 💡 使用场景

### 餐厅场景
1. 在餐厅大屏显示二维码
2. 顾客扫码为菜品投票
3. 顾客扫码发表用餐体验
4. 后厨实时查看反馈

### 企业场景
1. 员工餐厅满意度调查
2. 匿名收集员工意见
3. 实时菜品评价
4. 厨师服务评分

### 活动场景
1. 美食节现场投票
2. 厨艺比赛评分
3. 观众互动反馈
4. 即时问卷调查

---

## 🐛 常见问题

### Q: 扫码后无法访问？
**A**: 确保手机和电脑在同一局域网，并使用局域网 IP 地址而非 localhost。

### Q: 发帖失败？
**A**: 检查内容是否符合 5-500 字要求，确认网络连接正常。

### Q: 二维码不显示？
**A**: 刷新页面，检查服务器是否正常运行，查看浏览器控制台错误信息。

### Q: 投票后大屏没更新？
**A**: 投票会实时同步，大屏页面会自动刷新数据。如未更新，手动刷新大屏页面。

### Q: 点赞记录丢失？
**A**: 点赞记录保存在手机浏览器的 localStorage 中，清除浏览器数据会丢失记录。

---

## 📞 技术支持

如遇到问题，可以：
1. 查看服务器控制台日志
2. 检查浏览器开发者工具（F12）
3. 查看 `forum-data.json` 文件内容
4. 重启服务器

---

## 🎉 总结

通过二维码功能，系统实现了：
- ✅ 手机端便捷投票
- ✅ 匿名意见收集
- ✅ 实时互动反馈
- ✅ 无需安装 APP

让餐厅管理更智能，让顾客反馈更便捷！


